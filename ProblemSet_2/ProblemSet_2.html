<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.555">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Behram Radmanesh">

<title>Problem Set 2</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="ProblemSet_2_files/libs/clipboard/clipboard.min.js"></script>
<script src="ProblemSet_2_files/libs/quarto-html/quarto.js"></script>
<script src="ProblemSet_2_files/libs/quarto-html/popper.min.js"></script>
<script src="ProblemSet_2_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="ProblemSet_2_files/libs/quarto-html/anchor.min.js"></script>
<link href="ProblemSet_2_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="ProblemSet_2_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="ProblemSet_2_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="ProblemSet_2_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="ProblemSet_2_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
  <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#problem-1---dice-game" id="toc-problem-1---dice-game" class="nav-link active" data-scroll-target="#problem-1---dice-game">Problem 1 - Dice Game</a>
  <ul class="collapse">
  <li><a href="#part-a" id="toc-part-a" class="nav-link" data-scroll-target="#part-a">Part A</a></li>
  <li><a href="#part-b" id="toc-part-b" class="nav-link" data-scroll-target="#part-b">Part B</a></li>
  <li><a href="#part-c" id="toc-part-c" class="nav-link" data-scroll-target="#part-c">Part C</a></li>
  <li><a href="#part-d" id="toc-part-d" class="nav-link" data-scroll-target="#part-d">Part D</a></li>
  <li><a href="#part-e" id="toc-part-e" class="nav-link" data-scroll-target="#part-e">Part E</a></li>
  </ul></li>
  </ul>
</nav>
</div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Problem Set 2</h1><button type="button" class="btn code-tools-button dropdown-toggle" id="quarto-code-tools-menu" data-bs-toggle="dropdown" aria-expanded="false"><i class="bi"></i> Code</button><ul class="dropdown-menu dropdown-menu-end" aria-labelelledby="quarto-code-tools-menu"><li><a id="quarto-show-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Show All Code</a></li><li><a id="quarto-hide-all-code" class="dropdown-item" href="javascript:void(0)" role="button">Hide All Code</a></li><li><hr class="dropdown-divider"></li><li><a id="quarto-view-source" class="dropdown-item" href="javascript:void(0)" role="button">View Source</a></li></ul></div></div>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Behram Radmanesh </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<p><a href="https://github.com/MediciPrime/STATS506/tree/main/ProblemSet_2">Github Link</a></p>
<section id="problem-1---dice-game" class="level2">
<h2 class="anchored" data-anchor-id="problem-1---dice-game">Problem 1 - Dice Game</h2>
<p>This problem asks to create a function that codes for a dice game abiding by the following rules: - The game uses a 6-sided dice and costs $2 to play per die rolled - Winning roll requires a 3 or 5; anything else and you lose - Winning value 3 produces 6 dollars; while value 5 produces 10 dollars</p>
<section id="part-a" class="level3">
<h3 class="anchored" data-anchor-id="part-a">Part A</h3>
<section id="simple-loop" class="level4">
<h4 class="anchored" data-anchor-id="simple-loop">Simple Loop</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Function takes as input the number of dice rolls to play</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>loop <span class="ot">&lt;-</span> <span class="cf">function</span>(num) {</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Check if input is numeric</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(num) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If numeric then check if contains decimal</span></span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given it's not a decimal convert to integer</span></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Given decimal check if a negative number was given</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If negative decimal then tell user how number for converted</span></span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Negative entered value:"</span>, num, <span class="st">"was converted to"</span>, <span class="fu">as.integer</span>(<span class="sc">-</span>num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">-</span>num)</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given positive decimal convert accordingly</span></span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Entered value:"</span>, num, <span class="st">"converted to"</span>, <span class="fu">as.integer</span>(num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(num) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Please enter a natural number, eg. 1, 2, 3, ..."</span>)</span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create player deficit</span></span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a>  winnings <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>num)</span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Simulate 'n'= num Dice Rolls</span></span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>  rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Use for loop to calculate total winnings</span></span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> rolls) {</span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>    <span class="do">## if 3 is rolled add $6 to the winnings</span></span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>      winnings <span class="ot">&lt;-</span> winnings <span class="sc">+</span> <span class="dv">6</span></span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>    <span class="do">## if 5 is rolled add $10 to the winnings</span></span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>      winnings <span class="ot">&lt;-</span> winnings <span class="sc">+</span> <span class="dv">10</span></span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cat</span>(<span class="st">"Total Winnings:"</span>, winnings))</span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="vetorized-function" class="level4">
<h4 class="anchored" data-anchor-id="vetorized-function">Vetorized Function</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Function takes as input the number of dice rolls to play</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>vectorized <span class="ot">&lt;-</span> <span class="cf">function</span>(num) {</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a> <span class="do">## Check if input is numeric</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(num) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If numeric then check if contains decimal</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given it's not a decimal convert to integer</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Given decimal check if a negative number was given</span></span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If negative decimal then tell user how number for converted</span></span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Negative entered value:"</span>, num, <span class="st">"was converted to"</span>, <span class="fu">as.integer</span>(<span class="sc">-</span>num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">-</span>num)</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given positive decimal convert accordingly</span></span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Entered value:"</span>, num, <span class="st">"converted to"</span>, <span class="fu">as.integer</span>(num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(num) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Please enter a natural number, eg. 1, 2, 3, ..."</span>)</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create player deficit</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>  deficit <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>num)</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Simulate 'n'= num Dice Rolls</span></span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">## create a vector specifying winnings for each roll</span></span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>  rollWinnings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="do">## using 'rolls' to index over the 'rollWinnings' vector</span></span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sum over all the possible winnings</span></span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>  winnings <span class="ot">&lt;-</span> <span class="fu">sum</span>(rollWinnings[rolls])</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cat</span>(<span class="st">"Total Winnings:"</span>, winnings<span class="sc">+</span>deficit))</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="vectorized-with-tables" class="level4">
<h4 class="anchored" data-anchor-id="vectorized-with-tables">Vectorized with Tables</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Function takes as input the number of dice rolls to play</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>tableVectorized <span class="ot">&lt;-</span> <span class="cf">function</span>(num) {</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Check if input is numeric</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(num) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If numeric then check if contains decimal</span></span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given it's not a decimal convert to integer</span></span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Given decimal check if a negative number was given</span></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If negative decimal then tell user how number for converted</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Negative entered value:"</span>, num, <span class="st">"was converted to"</span>, <span class="fu">as.integer</span>(<span class="sc">-</span>num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">-</span>num)</span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given positive decimal convert accordingly</span></span>
<span id="cb3-25"><a href="#cb3-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Entered value:"</span>, num, <span class="st">"converted to"</span>, <span class="fu">as.integer</span>(num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb3-26"><a href="#cb3-26" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb3-27"><a href="#cb3-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb3-28"><a href="#cb3-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-29"><a href="#cb3-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(num) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb3-30"><a href="#cb3-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Please enter a natural number, eg. 1, 2, 3, ..."</span>)</span>
<span id="cb3-31"><a href="#cb3-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb3-32"><a href="#cb3-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb3-33"><a href="#cb3-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-34"><a href="#cb3-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create player deficit</span></span>
<span id="cb3-35"><a href="#cb3-35" aria-hidden="true" tabindex="-1"></a>  deficit <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>num)</span>
<span id="cb3-36"><a href="#cb3-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-37"><a href="#cb3-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Simulate 'n'= num Dice Rolls &amp; place the results into a table</span></span>
<span id="cb3-38"><a href="#cb3-38" aria-hidden="true" tabindex="-1"></a>  tRolls <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb3-39"><a href="#cb3-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-40"><a href="#cb3-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">## create a vector specifying winnings for each roll</span></span>
<span id="cb3-41"><a href="#cb3-41" aria-hidden="true" tabindex="-1"></a>  rollWinnings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb3-42"><a href="#cb3-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-43"><a href="#cb3-43" aria-hidden="true" tabindex="-1"></a>  <span class="do">## using 'tRolls' table to index over the 'rollWinnings' vector</span></span>
<span id="cb3-44"><a href="#cb3-44" aria-hidden="true" tabindex="-1"></a>  <span class="do">## the table form avoids unnecessary looping over the rolls</span></span>
<span id="cb3-45"><a href="#cb3-45" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sum over all the possible winnings</span></span>
<span id="cb3-46"><a href="#cb3-46" aria-hidden="true" tabindex="-1"></a>  winnings <span class="ot">&lt;-</span> <span class="fu">sum</span>(rollWinnings[<span class="fu">as.numeric</span>(<span class="fu">names</span>(tRolls))] <span class="sc">*</span> tRolls)</span>
<span id="cb3-47"><a href="#cb3-47" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb3-48"><a href="#cb3-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cat</span>(<span class="st">"Total Winnings: "</span>, winnings<span class="sc">+</span>deficit))</span>
<span id="cb3-49"><a href="#cb3-49" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="loop-with-apply" class="level4">
<h4 class="anchored" data-anchor-id="loop-with-apply">Loop with Apply</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Function takes as input the number of dice rolls to play</span></span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>loopApply <span class="ot">&lt;-</span> <span class="cf">function</span>(num) {</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Check if input is numeric</span></span>
<span id="cb4-5"><a href="#cb4-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(num) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb4-6"><a href="#cb4-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-7"><a href="#cb4-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If numeric then check if contains decimal</span></span>
<span id="cb4-8"><a href="#cb4-8" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb4-9"><a href="#cb4-9" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-10"><a href="#cb4-10" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given it's not a decimal convert to integer</span></span>
<span id="cb4-11"><a href="#cb4-11" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb4-12"><a href="#cb4-12" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-13"><a href="#cb4-13" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-14"><a href="#cb4-14" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Given decimal check if a negative number was given</span></span>
<span id="cb4-15"><a href="#cb4-15" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb4-16"><a href="#cb4-16" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-17"><a href="#cb4-17" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If negative decimal then tell user how number for converted</span></span>
<span id="cb4-18"><a href="#cb4-18" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Negative entered value:"</span>, num, <span class="st">"was converted to"</span>, <span class="fu">as.integer</span>(<span class="sc">-</span>num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-19"><a href="#cb4-19" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">-</span>num)</span>
<span id="cb4-20"><a href="#cb4-20" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-21"><a href="#cb4-21" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb4-22"><a href="#cb4-22" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb4-23"><a href="#cb4-23" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb4-24"><a href="#cb4-24" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given positive decimal convert accordingly</span></span>
<span id="cb4-25"><a href="#cb4-25" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Entered value:"</span>, num, <span class="st">"converted to"</span>, <span class="fu">as.integer</span>(num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb4-26"><a href="#cb4-26" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb4-27"><a href="#cb4-27" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb4-28"><a href="#cb4-28" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(num) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb4-30"><a href="#cb4-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Please enter a natural number, eg. 1, 2, 3, ..."</span>)</span>
<span id="cb4-31"><a href="#cb4-31" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb4-32"><a href="#cb4-32" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb4-33"><a href="#cb4-33" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-34"><a href="#cb4-34" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create player deficit</span></span>
<span id="cb4-35"><a href="#cb4-35" aria-hidden="true" tabindex="-1"></a>  deficit <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>num)</span>
<span id="cb4-36"><a href="#cb4-36" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-37"><a href="#cb4-37" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Simulate 'n'= num Dice Rolls</span></span>
<span id="cb4-38"><a href="#cb4-38" aria-hidden="true" tabindex="-1"></a>  rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb4-39"><a href="#cb4-39" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-40"><a href="#cb4-40" aria-hidden="true" tabindex="-1"></a>  <span class="do">## create a vector specifying winnings for each roll</span></span>
<span id="cb4-41"><a href="#cb4-41" aria-hidden="true" tabindex="-1"></a>  rollWinnings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb4-42"><a href="#cb4-42" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-43"><a href="#cb4-43" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Using the apply function to sum up the winnings</span></span>
<span id="cb4-44"><a href="#cb4-44" aria-hidden="true" tabindex="-1"></a>  winnings <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.matrix</span>(rollWinnings[rolls]), <span class="dv">2</span>, sum)</span>
<span id="cb4-45"><a href="#cb4-45" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb4-46"><a href="#cb4-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cat</span>(<span class="st">"Total Winnings: "</span>, winnings<span class="sc">+</span>deficit))</span>
<span id="cb4-47"><a href="#cb4-47" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
</section>
<section id="part-b" class="level3">
<h3 class="anchored" data-anchor-id="part-b">Part B</h3>
<p>The following bit of code is here to demonstrate through examples that each of the functions work.</p>
<section id="simple-loop-1" class="level4">
<h4 class="anchored" data-anchor-id="simple-loop-1">Simple Loop</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loop</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: -6</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loop</span>(<span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: 2040</code></pre>
</div>
</div>
</section>
<section id="vectorized-function" class="level4">
<h4 class="anchored" data-anchor-id="vectorized-function">Vectorized Function</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vectorized</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: -6</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vectorized</span>(<span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: 1932</code></pre>
</div>
</div>
</section>
<section id="vectorized-with-tables-1" class="level4">
<h4 class="anchored" data-anchor-id="vectorized-with-tables-1">Vectorized with Tables</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tableVectorized</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  -6</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tableVectorized</span>(<span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  1518</code></pre>
</div>
</div>
</section>
<section id="loop-with-apply-1" class="level4">
<h4 class="anchored" data-anchor-id="loop-with-apply-1">Loop with Apply</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loopApply</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  4</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loopApply</span>(<span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  2312</code></pre>
</div>
</div>
</section>
</section>
<section id="part-c" class="level3">
<h3 class="anchored" data-anchor-id="part-c">Part C</h3>
<p>Set a seed in order to demonstrate that each of the 4 functions output the same results.</p>
<section id="simple-loop-2" class="level4">
<h4 class="anchored" data-anchor-id="simple-loop-2">Simple Loop</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loop</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loop</span>(<span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: 2532</code></pre>
</div>
</div>
</section>
<section id="vectorized-function-1" class="level4">
<h4 class="anchored" data-anchor-id="vectorized-function-1">Vectorized Function</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">vectorized</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: 0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a><span class="fu">vectorized</span>(<span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: 2532</code></pre>
</div>
</div>
</section>
<section id="vectorized-with-tables-2" class="level4">
<h4 class="anchored" data-anchor-id="vectorized-with-tables-2">Vectorized with Tables</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a><span class="fu">tableVectorized</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a><span class="fu">tableVectorized</span>(<span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  2532</code></pre>
</div>
</div>
</section>
<section id="loop-with-apply-2" class="level4">
<h4 class="anchored" data-anchor-id="loop-with-apply-2">Loop with Apply</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a><span class="fu">loopApply</span>(<span class="dv">3</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  0</code></pre>
</div>
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">loopApply</span>(<span class="dv">3000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  2532</code></pre>
</div>
</div>
</section>
</section>
<section id="part-d" class="level3">
<h3 class="anchored" data-anchor-id="part-d">Part D</h3>
<p>The ‘microbenchmark’ package will now be used to calculate the speed for each of the implementations.</p>
<section id="simple-loop-3" class="level4">
<h4 class="anchored" data-anchor-id="simple-loop-3">Simple Loop</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"microbenchmark"</span>)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 1000 vs 100,000</span></span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">loop</span>(<span class="dv">1000</span>), <span class="fu">loop</span>(<span class="dv">100000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: 860Total Winnings: 542Total Winnings: 676Total Winnings: 67860Total Winnings: 836Total Winnings: 65614Total Winnings: 538Total Winnings: 66676Total Winnings: 644Total Winnings: 580Total Winnings: 598Total Winnings: 640Total Winnings: 67108Total Winnings: 67724Total Winnings: 66074Total Winnings: 708Total Winnings: 598Total Winnings: 446Total Winnings: 776Total Winnings: 842Total Winnings: 614Total Winnings: 65860Total Winnings: 708Total Winnings: 672Total Winnings: 66468Total Winnings: 66298Total Winnings: 66980Total Winnings: 634Total Winnings: 67514Total Winnings: 67912Total Winnings: 656Total Winnings: 66898Total Winnings: 650Total Winnings: 66924Total Winnings: 67364Total Winnings: 620Total Winnings: 908Total Winnings: 65398Total Winnings: 65650Total Winnings: 68248Total Winnings: 628Total Winnings: 68908Total Winnings: 490Total Winnings: 65828Total Winnings: 65104Total Winnings: 562Total Winnings: 65432Total Winnings: 66318Total Winnings: 65526Total Winnings: 500Total Winnings: 604Total Winnings: 560Total Winnings: 68600Total Winnings: 580Total Winnings: 562Total Winnings: 66552Total Winnings: 65520Total Winnings: 67498Total Winnings: 65754Total Winnings: 622Total Winnings: 544Total Winnings: 64458Total Winnings: 784Total Winnings: 712Total Winnings: 596Total Winnings: 954Total Winnings: 546Total Winnings: 65350Total Winnings: 624Total Winnings: 66142Total Winnings: 702Total Winnings: 66382Total Winnings: 67736Total Winnings: 798Total Winnings: 65314Total Winnings: 552Total Winnings: 442Total Winnings: 64370Total Winnings: 66612Total Winnings: 64248Total Winnings: 67018Total Winnings: 66402Total Winnings: 67854Total Winnings: 686Total Winnings: 66982Total Winnings: 836Total Winnings: 698Total Winnings: 510Total Winnings: 492Total Winnings: 694Total Winnings: 66268Total Winnings: 66378Total Winnings: 69656Total Winnings: 65482Total Winnings: 64314Total Winnings: 596Total Winnings: 63970Total Winnings: 550Total Winnings: 69130Total Winnings: 67332Total Winnings: 66112Total Winnings: 68694Total Winnings: 68046Total Winnings: 65140Total Winnings: 782Total Winnings: 524Total Winnings: 622Total Winnings: 764Total Winnings: 810Total Winnings: 488Total Winnings: 776Total Winnings: 66454Total Winnings: 66620Total Winnings: 64938Total Winnings: 65694Total Winnings: 516Total Winnings: 526Total Winnings: 68950Total Winnings: 65938Total Winnings: 66844Total Winnings: 68170Total Winnings: 67638Total Winnings: 66180Total Winnings: 648Total Winnings: 70030Total Winnings: 66444Total Winnings: 66202Total Winnings: 480Total Winnings: 66184Total Winnings: 720Total Winnings: 566Total Winnings: 1086Total Winnings: 68820Total Winnings: 524Total Winnings: 492Total Winnings: 458Total Winnings: 67662Total Winnings: 678Total Winnings: 66326Total Winnings: 65736Total Winnings: 67894Total Winnings: 492Total Winnings: 558Total Winnings: 65662Total Winnings: 628Total Winnings: 594Total Winnings: 508Total Winnings: 478Total Winnings: 66210Total Winnings: 64608Total Winnings: 724Total Winnings: 726Total Winnings: 66932Total Winnings: 650Total Winnings: 712Total Winnings: 67884Total Winnings: 66198Total Winnings: 586Total Winnings: 392Total Winnings: 65948Total Winnings: 600Total Winnings: 660Total Winnings: 69452Total Winnings: 67544Total Winnings: 67004Total Winnings: 782Total Winnings: 750Total Winnings: 694Total Winnings: 642Total Winnings: 66552Total Winnings: 742Total Winnings: 704Total Winnings: 946Total Winnings: 67452Total Winnings: 67380Total Winnings: 65976Total Winnings: 598Total Winnings: 66276Total Winnings: 652Total Winnings: 66898Total Winnings: 65562Total Winnings: 66844Total Winnings: 68078Total Winnings: 432Total Winnings: 67026Total Winnings: 67042Total Winnings: 590Total Winnings: 65866Total Winnings: 894Total Winnings: 820Total Winnings: 66520Total Winnings: 708Total Winnings: 65344Total Winnings: 742Total Winnings: 67058Total Winnings: 864Total Winnings: 668Total Winnings: 66480Total Winnings: 66984Total Winnings: 920</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: microseconds
        expr    min     lq     mean median     uq     max neval
  loop(1000)   71.6   83.4  104.140   95.3  116.0   386.2   100
 loop(1e+05) 6587.4 7282.6 7506.026 7508.9 7639.2 12289.1   100</code></pre>
</div>
</div>
</section>
<section id="vectorized-function-2" class="level4">
<h4 class="anchored" data-anchor-id="vectorized-function-2">Vectorized Function</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input 1,000 vs 100,000</span></span>
<span id="cb40-2"><a href="#cb40-2" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">vectorized</span>(<span class="dv">1000</span>), <span class="fu">vectorized</span>(<span class="dv">100000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings: 728Total Winnings: 630Total Winnings: 65052Total Winnings: 662Total Winnings: 65806Total Winnings: 772Total Winnings: 1062Total Winnings: 702Total Winnings: 69564Total Winnings: 65816Total Winnings: 65972Total Winnings: 69290Total Winnings: 644Total Winnings: 68378Total Winnings: 67144Total Winnings: 67720Total Winnings: 67306Total Winnings: 66412Total Winnings: 66804Total Winnings: 66478Total Winnings: 860Total Winnings: 612Total Winnings: 814Total Winnings: 67178Total Winnings: 65138Total Winnings: 648Total Winnings: 508Total Winnings: 782Total Winnings: 66346Total Winnings: 376Total Winnings: 66268Total Winnings: 614Total Winnings: 854Total Winnings: 582Total Winnings: 524Total Winnings: 578Total Winnings: 648Total Winnings: 66598Total Winnings: 524Total Winnings: 68682Total Winnings: 67792Total Winnings: 690Total Winnings: 416Total Winnings: 67890Total Winnings: 67128Total Winnings: 644Total Winnings: 916Total Winnings: 846Total Winnings: 68298Total Winnings: 702Total Winnings: 732Total Winnings: 67678Total Winnings: 67486Total Winnings: 66782Total Winnings: 930Total Winnings: 68358Total Winnings: 67826Total Winnings: 64906Total Winnings: 674Total Winnings: 614Total Winnings: 546Total Winnings: 65836Total Winnings: 530Total Winnings: 66644Total Winnings: 63976Total Winnings: 66256Total Winnings: 700Total Winnings: 67926Total Winnings: 64418Total Winnings: 526Total Winnings: 422Total Winnings: 66202Total Winnings: 69164Total Winnings: 67640Total Winnings: 702Total Winnings: 66162Total Winnings: 622Total Winnings: 65952Total Winnings: 402Total Winnings: 702Total Winnings: 472Total Winnings: 66846Total Winnings: 672Total Winnings: 68382Total Winnings: 66560Total Winnings: 608Total Winnings: 580Total Winnings: 552Total Winnings: 66778Total Winnings: 65328Total Winnings: 518Total Winnings: 66396Total Winnings: 68084Total Winnings: 816Total Winnings: 65982Total Winnings: 696Total Winnings: 68046Total Winnings: 614Total Winnings: 720Total Winnings: 666Total Winnings: 67194Total Winnings: 810Total Winnings: 64478Total Winnings: 67936Total Winnings: 64586Total Winnings: 628Total Winnings: 710Total Winnings: 588Total Winnings: 474Total Winnings: 742Total Winnings: 696Total Winnings: 66884Total Winnings: 65802Total Winnings: 67956Total Winnings: 522Total Winnings: 968Total Winnings: 65414Total Winnings: 68312Total Winnings: 848Total Winnings: 65614Total Winnings: 768Total Winnings: 67270Total Winnings: 686Total Winnings: 66546Total Winnings: 606Total Winnings: 68256Total Winnings: 892Total Winnings: 66408Total Winnings: 67246Total Winnings: 65974Total Winnings: 66090Total Winnings: 63104Total Winnings: 660Total Winnings: 680Total Winnings: 67054Total Winnings: 652Total Winnings: 66662Total Winnings: 552Total Winnings: 692Total Winnings: 774Total Winnings: 67416Total Winnings: 64346Total Winnings: 696Total Winnings: 67738Total Winnings: 64846Total Winnings: 66558Total Winnings: 598Total Winnings: 580Total Winnings: 66284Total Winnings: 716Total Winnings: 774Total Winnings: 802Total Winnings: 66474Total Winnings: 570Total Winnings: 67044Total Winnings: 758Total Winnings: 67510Total Winnings: 68224Total Winnings: 478Total Winnings: 888Total Winnings: 67128Total Winnings: 536Total Winnings: 702Total Winnings: 65932Total Winnings: 712Total Winnings: 624Total Winnings: 65432Total Winnings: 66434Total Winnings: 65048Total Winnings: 704Total Winnings: 67628Total Winnings: 68008Total Winnings: 65976Total Winnings: 684Total Winnings: 67576Total Winnings: 426Total Winnings: 732Total Winnings: 566Total Winnings: 790Total Winnings: 65492Total Winnings: 770Total Winnings: 740Total Winnings: 67762Total Winnings: 896Total Winnings: 722Total Winnings: 706Total Winnings: 68964Total Winnings: 702Total Winnings: 484Total Winnings: 67784Total Winnings: 762Total Winnings: 67704Total Winnings: 66086Total Winnings: 67130Total Winnings: 64372Total Winnings: 66624Total Winnings: 68880Total Winnings: 676Total Winnings: 67134Total Winnings: 67198</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: microseconds
              expr    min      lq     mean  median     uq    max neval
  vectorized(1000)   50.5   60.95   78.258   69.15   89.8  175.4   100
 vectorized(1e+05) 4508.9 4918.70 5346.567 5239.90 5519.4 9294.4   100</code></pre>
</div>
</div>
</section>
<section id="vectorized-with-tables-3" class="level4">
<h4 class="anchored" data-anchor-id="vectorized-with-tables-3">Vectorized with Tables</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input 1,000 vs 100,000</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">tableVectorized</span>(<span class="dv">1000</span>), <span class="fu">tableVectorized</span>(<span class="dv">100000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  65944Total Winnings:  616Total Winnings:  586Total Winnings:  652Total Winnings:  308Total Winnings:  67902Total Winnings:  588Total Winnings:  69458Total Winnings:  69448Total Winnings:  66816Total Winnings:  802Total Winnings:  67350Total Winnings:  68562Total Winnings:  65852Total Winnings:  688Total Winnings:  736Total Winnings:  64784Total Winnings:  66932Total Winnings:  66314Total Winnings:  626Total Winnings:  614Total Winnings:  550Total Winnings:  66880Total Winnings:  65378Total Winnings:  65852Total Winnings:  572Total Winnings:  67000Total Winnings:  65102Total Winnings:  700Total Winnings:  714Total Winnings:  64194Total Winnings:  67568Total Winnings:  66190Total Winnings:  66460Total Winnings:  67110Total Winnings:  552Total Winnings:  68228Total Winnings:  64780Total Winnings:  844Total Winnings:  68048Total Winnings:  730Total Winnings:  866Total Winnings:  822Total Winnings:  65832Total Winnings:  68092Total Winnings:  66224Total Winnings:  64246Total Winnings:  67010Total Winnings:  64910Total Winnings:  604Total Winnings:  702Total Winnings:  570Total Winnings:  700Total Winnings:  420Total Winnings:  444Total Winnings:  65474Total Winnings:  68282Total Winnings:  66612Total Winnings:  66810Total Winnings:  566Total Winnings:  624Total Winnings:  66726Total Winnings:  66670Total Winnings:  710Total Winnings:  66666Total Winnings:  678Total Winnings:  66406Total Winnings:  67258Total Winnings:  67494Total Winnings:  568Total Winnings:  374Total Winnings:  646Total Winnings:  368Total Winnings:  66826Total Winnings:  67056Total Winnings:  66158Total Winnings:  344Total Winnings:  64434Total Winnings:  694Total Winnings:  64650Total Winnings:  66220Total Winnings:  69202Total Winnings:  66540Total Winnings:  840Total Winnings:  760Total Winnings:  782Total Winnings:  720Total Winnings:  68136Total Winnings:  67850Total Winnings:  770Total Winnings:  66440Total Winnings:  532Total Winnings:  66502Total Winnings:  658Total Winnings:  66012Total Winnings:  440Total Winnings:  66744Total Winnings:  564Total Winnings:  66636Total Winnings:  690Total Winnings:  718Total Winnings:  532Total Winnings:  708Total Winnings:  572Total Winnings:  65298Total Winnings:  664Total Winnings:  65818Total Winnings:  846Total Winnings:  698Total Winnings:  66476Total Winnings:  664Total Winnings:  528Total Winnings:  65802Total Winnings:  622Total Winnings:  576Total Winnings:  66562Total Winnings:  650Total Winnings:  67252Total Winnings:  764Total Winnings:  65160Total Winnings:  760Total Winnings:  700Total Winnings:  66394Total Winnings:  614Total Winnings:  648Total Winnings:  68074Total Winnings:  584Total Winnings:  598Total Winnings:  68506Total Winnings:  770Total Winnings:  710Total Winnings:  66902Total Winnings:  67590Total Winnings:  576Total Winnings:  694Total Winnings:  67274Total Winnings:  66814Total Winnings:  500Total Winnings:  66550Total Winnings:  65704Total Winnings:  750Total Winnings:  552Total Winnings:  692Total Winnings:  868Total Winnings:  66680Total Winnings:  64912Total Winnings:  784Total Winnings:  66852Total Winnings:  838Total Winnings:  532Total Winnings:  67188Total Winnings:  66850Total Winnings:  63700Total Winnings:  65994Total Winnings:  66474Total Winnings:  700Total Winnings:  66958Total Winnings:  642Total Winnings:  620Total Winnings:  558Total Winnings:  66502Total Winnings:  1024Total Winnings:  63028Total Winnings:  544Total Winnings:  65128Total Winnings:  65642Total Winnings:  948Total Winnings:  754Total Winnings:  69332Total Winnings:  506Total Winnings:  66214Total Winnings:  466Total Winnings:  66382Total Winnings:  66966Total Winnings:  65480Total Winnings:  65516Total Winnings:  748Total Winnings:  65684Total Winnings:  66530Total Winnings:  786Total Winnings:  66192Total Winnings:  722Total Winnings:  844Total Winnings:  68974Total Winnings:  868Total Winnings:  372Total Winnings:  820Total Winnings:  692Total Winnings:  65820Total Winnings:  66990Total Winnings:  66786Total Winnings:  68040Total Winnings:  636Total Winnings:  442Total Winnings:  66602Total Winnings:  480Total Winnings:  844Total Winnings:  632Total Winnings:  66818Total Winnings:  468</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: microseconds
                   expr    min      lq      mean  median       uq     max neval
  tableVectorized(1000)  134.1  166.55   228.597  220.00   269.85   495.2   100
 tableVectorized(1e+05) 7387.1 8965.30 10012.608 9701.45 10591.15 14292.5   100</code></pre>
</div>
</div>
</section>
<section id="loop-with-apply-3" class="level4">
<h4 class="anchored" data-anchor-id="loop-with-apply-3">Loop with Apply</h4>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Input 1,000 vs 100,000</span></span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">loopApply</span>(<span class="dv">1000</span>), <span class="fu">loopApply</span>(<span class="dv">100000</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Total Winnings:  64802Total Winnings:  592Total Winnings:  420Total Winnings:  670Total Winnings:  534Total Winnings:  66046Total Winnings:  538Total Winnings:  65046Total Winnings:  708Total Winnings:  610Total Winnings:  686Total Winnings:  652Total Winnings:  458Total Winnings:  486Total Winnings:  67782Total Winnings:  63156Total Winnings:  64814Total Winnings:  65272Total Winnings:  66166Total Winnings:  68174Total Winnings:  400Total Winnings:  656Total Winnings:  68864Total Winnings:  68796Total Winnings:  738Total Winnings:  66544Total Winnings:  1058Total Winnings:  626Total Winnings:  64876Total Winnings:  63530Total Winnings:  67300Total Winnings:  69782Total Winnings:  67054Total Winnings:  66024Total Winnings:  65706Total Winnings:  66760Total Winnings:  67868Total Winnings:  848Total Winnings:  840Total Winnings:  724Total Winnings:  708Total Winnings:  594Total Winnings:  67124Total Winnings:  558Total Winnings:  672Total Winnings:  606Total Winnings:  780Total Winnings:  66206Total Winnings:  582Total Winnings:  464Total Winnings:  872Total Winnings:  66940Total Winnings:  66042Total Winnings:  872Total Winnings:  66676Total Winnings:  68326Total Winnings:  69560Total Winnings:  624Total Winnings:  548Total Winnings:  65336Total Winnings:  744Total Winnings:  66290Total Winnings:  722Total Winnings:  66326Total Winnings:  594Total Winnings:  67920Total Winnings:  66182Total Winnings:  478Total Winnings:  66928Total Winnings:  68832Total Winnings:  66276Total Winnings:  66676Total Winnings:  698Total Winnings:  66012Total Winnings:  66152Total Winnings:  614Total Winnings:  66428Total Winnings:  720Total Winnings:  590Total Winnings:  66270Total Winnings:  782Total Winnings:  67030Total Winnings:  66124Total Winnings:  882Total Winnings:  918Total Winnings:  66454Total Winnings:  820Total Winnings:  692Total Winnings:  65964Total Winnings:  582Total Winnings:  698Total Winnings:  632Total Winnings:  770Total Winnings:  66678Total Winnings:  582Total Winnings:  65720Total Winnings:  738Total Winnings:  65772Total Winnings:  676Total Winnings:  67706Total Winnings:  562Total Winnings:  564Total Winnings:  66734Total Winnings:  67226Total Winnings:  698Total Winnings:  62768Total Winnings:  764Total Winnings:  65822Total Winnings:  66754Total Winnings:  724Total Winnings:  67056Total Winnings:  626Total Winnings:  512Total Winnings:  646Total Winnings:  65914Total Winnings:  65372Total Winnings:  542Total Winnings:  906Total Winnings:  66088Total Winnings:  530Total Winnings:  65972Total Winnings:  67646Total Winnings:  784Total Winnings:  774Total Winnings:  504Total Winnings:  600Total Winnings:  68260Total Winnings:  738Total Winnings:  65960Total Winnings:  67106Total Winnings:  556Total Winnings:  702Total Winnings:  756Total Winnings:  68158Total Winnings:  720Total Winnings:  862Total Winnings:  66936Total Winnings:  67302Total Winnings:  658Total Winnings:  612Total Winnings:  806Total Winnings:  66946Total Winnings:  65612Total Winnings:  692Total Winnings:  408Total Winnings:  68308Total Winnings:  578Total Winnings:  644Total Winnings:  668Total Winnings:  664Total Winnings:  64702Total Winnings:  510Total Winnings:  598Total Winnings:  446Total Winnings:  68054Total Winnings:  64254Total Winnings:  532Total Winnings:  812Total Winnings:  65838Total Winnings:  654Total Winnings:  68084Total Winnings:  598Total Winnings:  796Total Winnings:  65358Total Winnings:  64862Total Winnings:  67128Total Winnings:  628Total Winnings:  694Total Winnings:  67212Total Winnings:  726Total Winnings:  67534Total Winnings:  65804Total Winnings:  65696Total Winnings:  692Total Winnings:  67374Total Winnings:  67130Total Winnings:  67586Total Winnings:  588Total Winnings:  656Total Winnings:  65908Total Winnings:  686Total Winnings:  66478Total Winnings:  67306Total Winnings:  65976Total Winnings:  65130Total Winnings:  628Total Winnings:  634Total Winnings:  66940Total Winnings:  67216Total Winnings:  68238Total Winnings:  65596Total Winnings:  66734Total Winnings:  65754Total Winnings:  67516Total Winnings:  746Total Winnings:  67188Total Winnings:  66566Total Winnings:  66394Total Winnings:  748Total Winnings:  66212</code></pre>
</div>
<div class="cell-output cell-output-stdout">
<pre><code>Unit: microseconds
             expr    min     lq     mean  median      uq     max neval
  loopApply(1000)   68.2   78.9  117.366  107.25  131.20   376.2   100
 loopApply(1e+05) 5246.5 6147.5 6689.237 6434.05 6873.45 11983.8   100</code></pre>
</div>
</div>
<p>I was surprised to see that the Vectorized function which utilized a table was slower than all the other functions. I was under the assumption that using a table would have at least reduced the calculation time over the for loop used for the simple loop function, since we could use the table’s index. Aside from that surprising result, loopApply was faster than the simple loop function but the fastest was the purely vectorized function.</p>
<p>Thus in order of the fastest to the slowest:</p>
<ol type="1">
<li>vectorized</li>
<li>loopApply</li>
<li>loop ‘simple loop’</li>
<li>tableVectorized</li>
</ol>
</section>
</section>
<section id="part-e" class="level3">
<h3 class="anchored" data-anchor-id="part-e">Part E</h3>
<section id="monte-carlo-simulation" class="level4">
<h4 class="anchored" data-anchor-id="monte-carlo-simulation">Monte Carlo Simulation</h4>
<p>The idea of a game being fair in my opinion relies upon an equal chance for the player to make money vs lose money. For example, in a game of tossing a coin and calling a side, the player would have an equal chance of both winning and losing.</p>
<div class="cell">
<details class="code-fold">
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a><span class="do">## Monte Carlo simulation</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>monte <span class="ot">&lt;-</span> <span class="cf">function</span>(reps) {</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a>  <span class="do">## roll the dice from 1 to 1000 on various increments</span></span>
<span id="cb49-5"><a href="#cb49-5" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (rolls <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">60</span>,<span class="dv">80</span>,<span class="dv">100</span>,<span class="dv">1000</span>)) {</span>
<span id="cb49-6"><a href="#cb49-6" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-7"><a href="#cb49-7" aria-hidden="true" tabindex="-1"></a>    <span class="do">## create an empty vector sized according to the reps</span></span>
<span id="cb49-8"><a href="#cb49-8" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> reps)</span>
<span id="cb49-9"><a href="#cb49-9" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb49-10"><a href="#cb49-10" aria-hidden="true" tabindex="-1"></a>    <span class="do">## cycle through the reps and calculate the total winnings</span></span>
<span id="cb49-11"><a href="#cb49-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(reps)) {</span>
<span id="cb49-12"><a href="#cb49-12" aria-hidden="true" tabindex="-1"></a>      v[i] <span class="ot">&lt;-</span> <span class="fu">vectorized</span>(rolls)</span>
<span id="cb49-13"><a href="#cb49-13" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb49-14"><a href="#cb49-14" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb49-15"><a href="#cb49-15" aria-hidden="true" tabindex="-1"></a>    <span class="do">## save rolls and their winnings as a table</span></span>
<span id="cb49-16"><a href="#cb49-16" aria-hidden="true" tabindex="-1"></a>    winnings <span class="ot">&lt;-</span> <span class="fu">table</span>(v)</span>
<span id="cb49-17"><a href="#cb49-17" aria-hidden="true" tabindex="-1"></a>    <span class="do">## calculate probability to rolls that result in a profit</span></span>
<span id="cb49-18"><a href="#cb49-18" aria-hidden="true" tabindex="-1"></a>    profit <span class="ot">&lt;-</span> <span class="fu">sum</span>(winnings[<span class="fu">as.numeric</span>(<span class="fu">names</span>(winnings))<span class="sc">&gt;</span>(<span class="dv">0</span>)])<span class="sc">/</span>reps</span>
<span id="cb49-19"><a href="#cb49-19" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb49-20"><a href="#cb49-20" aria-hidden="true" tabindex="-1"></a>    <span class="do">## print the current roll and the amount profit</span></span>
<span id="cb49-21"><a href="#cb49-21" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Rolls:"</span>, rolls, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb49-22"><a href="#cb49-22" aria-hidden="true" tabindex="-1"></a>        <span class="st">"P(Profit)="</span>, profit, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb49-23"><a href="#cb49-23" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb49-24"><a href="#cb49-24" aria-hidden="true" tabindex="-1"></a>  <span class="do">## at the very end return the final histogram containing the</span></span>
<span id="cb49-25"><a href="#cb49-25" aria-hidden="true" tabindex="-1"></a>  <span class="do">## user defined repetitions</span></span>
<span id="cb49-26"><a href="#cb49-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">hist</span>(v, <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram of"</span>, reps, <span class="st">"Repetition"</span>)))</span>
<span id="cb49-27"><a href="#cb49-27" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>According to the simulation it seems that this game is very much in favor of the player. If they spend 4 dollar (2 rolls) they will have about a 55% chance of making a profit. That chance will increase to about 90% if they spend 120 dollars (60 rolls). This game isn’t very ‘fair’ for the house since they are very likely to lose money. One way of making the game fair would be to lower the winnings for rolling a 3 or a 5.</p>
<!-- -->

</section>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb50" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> "Problem Set 2"</span></span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a><span class="an">author:</span><span class="co"> "Behram Radmanesh"</span></span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="an">format:</span><span class="co"> </span></span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a><span class="co">  html:</span></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a><span class="co">      code-fold: true</span></span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="co">      code-tools: true</span></span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a><span class="an">toc:</span><span class="co"> true</span></span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a><span class="co">[</span><span class="ot">Github Link</span><span class="co">](https://github.com/MediciPrime/STATS506/tree/main/ProblemSet_2)</span></span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a><span class="fu">## Problem 1 - Dice Game</span></span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>This problem asks to create a function that codes for a dice game abiding by the following rules:</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The game uses a 6-sided dice and costs $2 to play per die rolled</span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Winning roll requires a 3 or 5; anything else and you lose</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Winning value 3 produces 6 dollars; while value 5 produces 10 dollars</span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-20"><a href="#cb50-20" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part A</span></span>
<span id="cb50-21"><a href="#cb50-21" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Simple Loop</span></span>
<span id="cb50-22"><a href="#cb50-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-25"><a href="#cb50-25" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-26"><a href="#cb50-26" aria-hidden="true" tabindex="-1"></a><span class="do">## Function takes as input the number of dice rolls to play</span></span>
<span id="cb50-27"><a href="#cb50-27" aria-hidden="true" tabindex="-1"></a>loop <span class="ot">&lt;-</span> <span class="cf">function</span>(num) {</span>
<span id="cb50-28"><a href="#cb50-28" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-29"><a href="#cb50-29" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Check if input is numeric</span></span>
<span id="cb50-30"><a href="#cb50-30" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(num) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb50-31"><a href="#cb50-31" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-32"><a href="#cb50-32" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If numeric then check if contains decimal</span></span>
<span id="cb50-33"><a href="#cb50-33" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb50-34"><a href="#cb50-34" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-35"><a href="#cb50-35" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given it's not a decimal convert to integer</span></span>
<span id="cb50-36"><a href="#cb50-36" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb50-37"><a href="#cb50-37" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-38"><a href="#cb50-38" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-39"><a href="#cb50-39" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Given decimal check if a negative number was given</span></span>
<span id="cb50-40"><a href="#cb50-40" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb50-41"><a href="#cb50-41" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-42"><a href="#cb50-42" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If negative decimal then tell user how number for converted</span></span>
<span id="cb50-43"><a href="#cb50-43" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Negative entered value:"</span>, num, <span class="st">"was converted to"</span>, <span class="fu">as.integer</span>(<span class="sc">-</span>num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-44"><a href="#cb50-44" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">-</span>num)</span>
<span id="cb50-45"><a href="#cb50-45" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-46"><a href="#cb50-46" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-47"><a href="#cb50-47" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb50-48"><a href="#cb50-48" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-49"><a href="#cb50-49" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given positive decimal convert accordingly</span></span>
<span id="cb50-50"><a href="#cb50-50" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Entered value:"</span>, num, <span class="st">"converted to"</span>, <span class="fu">as.integer</span>(num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-51"><a href="#cb50-51" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb50-52"><a href="#cb50-52" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-53"><a href="#cb50-53" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-54"><a href="#cb50-54" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(num) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb50-55"><a href="#cb50-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Please enter a natural number, eg. 1, 2, 3, ..."</span>)</span>
<span id="cb50-56"><a href="#cb50-56" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb50-57"><a href="#cb50-57" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-58"><a href="#cb50-58" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-59"><a href="#cb50-59" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create player deficit</span></span>
<span id="cb50-60"><a href="#cb50-60" aria-hidden="true" tabindex="-1"></a>  winnings <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>num)</span>
<span id="cb50-61"><a href="#cb50-61" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-62"><a href="#cb50-62" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Simulate 'n'= num Dice Rolls</span></span>
<span id="cb50-63"><a href="#cb50-63" aria-hidden="true" tabindex="-1"></a>  rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb50-64"><a href="#cb50-64" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-65"><a href="#cb50-65" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Use for loop to calculate total winnings</span></span>
<span id="cb50-66"><a href="#cb50-66" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> rolls) {</span>
<span id="cb50-67"><a href="#cb50-67" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-68"><a href="#cb50-68" aria-hidden="true" tabindex="-1"></a>    <span class="do">## if 3 is rolled add $6 to the winnings</span></span>
<span id="cb50-69"><a href="#cb50-69" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">3</span>) {</span>
<span id="cb50-70"><a href="#cb50-70" aria-hidden="true" tabindex="-1"></a>      winnings <span class="ot">&lt;-</span> winnings <span class="sc">+</span> <span class="dv">6</span></span>
<span id="cb50-71"><a href="#cb50-71" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-72"><a href="#cb50-72" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-73"><a href="#cb50-73" aria-hidden="true" tabindex="-1"></a>    <span class="do">## if 5 is rolled add $10 to the winnings</span></span>
<span id="cb50-74"><a href="#cb50-74" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (i <span class="sc">==</span> <span class="dv">5</span>) {</span>
<span id="cb50-75"><a href="#cb50-75" aria-hidden="true" tabindex="-1"></a>      winnings <span class="ot">&lt;-</span> winnings <span class="sc">+</span> <span class="dv">10</span></span>
<span id="cb50-76"><a href="#cb50-76" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-77"><a href="#cb50-77" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-78"><a href="#cb50-78" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cat</span>(<span class="st">"Total Winnings:"</span>, winnings))</span>
<span id="cb50-79"><a href="#cb50-79" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-80"><a href="#cb50-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-81"><a href="#cb50-81" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-82"><a href="#cb50-82" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-83"><a href="#cb50-83" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vetorized Function</span></span>
<span id="cb50-84"><a href="#cb50-84" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-87"><a href="#cb50-87" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-88"><a href="#cb50-88" aria-hidden="true" tabindex="-1"></a><span class="do">## Function takes as input the number of dice rolls to play</span></span>
<span id="cb50-89"><a href="#cb50-89" aria-hidden="true" tabindex="-1"></a>vectorized <span class="ot">&lt;-</span> <span class="cf">function</span>(num) {</span>
<span id="cb50-90"><a href="#cb50-90" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-91"><a href="#cb50-91" aria-hidden="true" tabindex="-1"></a> <span class="do">## Check if input is numeric</span></span>
<span id="cb50-92"><a href="#cb50-92" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(num) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb50-93"><a href="#cb50-93" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-94"><a href="#cb50-94" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If numeric then check if contains decimal</span></span>
<span id="cb50-95"><a href="#cb50-95" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb50-96"><a href="#cb50-96" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-97"><a href="#cb50-97" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given it's not a decimal convert to integer</span></span>
<span id="cb50-98"><a href="#cb50-98" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb50-99"><a href="#cb50-99" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-100"><a href="#cb50-100" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-101"><a href="#cb50-101" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Given decimal check if a negative number was given</span></span>
<span id="cb50-102"><a href="#cb50-102" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb50-103"><a href="#cb50-103" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-104"><a href="#cb50-104" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If negative decimal then tell user how number for converted</span></span>
<span id="cb50-105"><a href="#cb50-105" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Negative entered value:"</span>, num, <span class="st">"was converted to"</span>, <span class="fu">as.integer</span>(<span class="sc">-</span>num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-106"><a href="#cb50-106" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">-</span>num)</span>
<span id="cb50-107"><a href="#cb50-107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-108"><a href="#cb50-108" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-109"><a href="#cb50-109" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb50-110"><a href="#cb50-110" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-111"><a href="#cb50-111" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given positive decimal convert accordingly</span></span>
<span id="cb50-112"><a href="#cb50-112" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Entered value:"</span>, num, <span class="st">"converted to"</span>, <span class="fu">as.integer</span>(num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-113"><a href="#cb50-113" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb50-114"><a href="#cb50-114" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-115"><a href="#cb50-115" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-116"><a href="#cb50-116" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(num) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb50-117"><a href="#cb50-117" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Please enter a natural number, eg. 1, 2, 3, ..."</span>)</span>
<span id="cb50-118"><a href="#cb50-118" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb50-119"><a href="#cb50-119" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-120"><a href="#cb50-120" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-121"><a href="#cb50-121" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create player deficit</span></span>
<span id="cb50-122"><a href="#cb50-122" aria-hidden="true" tabindex="-1"></a>  deficit <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>num)</span>
<span id="cb50-123"><a href="#cb50-123" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-124"><a href="#cb50-124" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Simulate 'n'= num Dice Rolls</span></span>
<span id="cb50-125"><a href="#cb50-125" aria-hidden="true" tabindex="-1"></a>  rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb50-126"><a href="#cb50-126" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-127"><a href="#cb50-127" aria-hidden="true" tabindex="-1"></a>  <span class="do">## create a vector specifying winnings for each roll</span></span>
<span id="cb50-128"><a href="#cb50-128" aria-hidden="true" tabindex="-1"></a>  rollWinnings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb50-129"><a href="#cb50-129" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-130"><a href="#cb50-130" aria-hidden="true" tabindex="-1"></a>  <span class="do">## using 'rolls' to index over the 'rollWinnings' vector</span></span>
<span id="cb50-131"><a href="#cb50-131" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sum over all the possible winnings</span></span>
<span id="cb50-132"><a href="#cb50-132" aria-hidden="true" tabindex="-1"></a>  winnings <span class="ot">&lt;-</span> <span class="fu">sum</span>(rollWinnings[rolls])</span>
<span id="cb50-133"><a href="#cb50-133" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-134"><a href="#cb50-134" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cat</span>(<span class="st">"Total Winnings:"</span>, winnings<span class="sc">+</span>deficit))</span>
<span id="cb50-135"><a href="#cb50-135" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-136"><a href="#cb50-136" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-137"><a href="#cb50-137" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-138"><a href="#cb50-138" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-139"><a href="#cb50-139" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vectorized with Tables</span></span>
<span id="cb50-140"><a href="#cb50-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-143"><a href="#cb50-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-144"><a href="#cb50-144" aria-hidden="true" tabindex="-1"></a><span class="do">## Function takes as input the number of dice rolls to play</span></span>
<span id="cb50-145"><a href="#cb50-145" aria-hidden="true" tabindex="-1"></a>tableVectorized <span class="ot">&lt;-</span> <span class="cf">function</span>(num) {</span>
<span id="cb50-146"><a href="#cb50-146" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-147"><a href="#cb50-147" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Check if input is numeric</span></span>
<span id="cb50-148"><a href="#cb50-148" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(num) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb50-149"><a href="#cb50-149" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-150"><a href="#cb50-150" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If numeric then check if contains decimal</span></span>
<span id="cb50-151"><a href="#cb50-151" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb50-152"><a href="#cb50-152" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-153"><a href="#cb50-153" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given it's not a decimal convert to integer</span></span>
<span id="cb50-154"><a href="#cb50-154" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb50-155"><a href="#cb50-155" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-156"><a href="#cb50-156" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-157"><a href="#cb50-157" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Given decimal check if a negative number was given</span></span>
<span id="cb50-158"><a href="#cb50-158" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb50-159"><a href="#cb50-159" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-160"><a href="#cb50-160" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If negative decimal then tell user how number for converted</span></span>
<span id="cb50-161"><a href="#cb50-161" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Negative entered value:"</span>, num, <span class="st">"was converted to"</span>, <span class="fu">as.integer</span>(<span class="sc">-</span>num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-162"><a href="#cb50-162" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">-</span>num)</span>
<span id="cb50-163"><a href="#cb50-163" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-164"><a href="#cb50-164" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-165"><a href="#cb50-165" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb50-166"><a href="#cb50-166" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-167"><a href="#cb50-167" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given positive decimal convert accordingly</span></span>
<span id="cb50-168"><a href="#cb50-168" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Entered value:"</span>, num, <span class="st">"converted to"</span>, <span class="fu">as.integer</span>(num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-169"><a href="#cb50-169" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb50-170"><a href="#cb50-170" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-171"><a href="#cb50-171" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-172"><a href="#cb50-172" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(num) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb50-173"><a href="#cb50-173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Please enter a natural number, eg. 1, 2, 3, ..."</span>)</span>
<span id="cb50-174"><a href="#cb50-174" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb50-175"><a href="#cb50-175" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-176"><a href="#cb50-176" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-177"><a href="#cb50-177" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create player deficit</span></span>
<span id="cb50-178"><a href="#cb50-178" aria-hidden="true" tabindex="-1"></a>  deficit <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>num)</span>
<span id="cb50-179"><a href="#cb50-179" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-180"><a href="#cb50-180" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Simulate 'n'= num Dice Rolls &amp; place the results into a table</span></span>
<span id="cb50-181"><a href="#cb50-181" aria-hidden="true" tabindex="-1"></a>  tRolls <span class="ot">&lt;-</span> <span class="fu">table</span>(<span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num, <span class="at">replace=</span><span class="cn">TRUE</span>))</span>
<span id="cb50-182"><a href="#cb50-182" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-183"><a href="#cb50-183" aria-hidden="true" tabindex="-1"></a>  <span class="do">## create a vector specifying winnings for each roll</span></span>
<span id="cb50-184"><a href="#cb50-184" aria-hidden="true" tabindex="-1"></a>  rollWinnings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb50-185"><a href="#cb50-185" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-186"><a href="#cb50-186" aria-hidden="true" tabindex="-1"></a>  <span class="do">## using 'tRolls' table to index over the 'rollWinnings' vector</span></span>
<span id="cb50-187"><a href="#cb50-187" aria-hidden="true" tabindex="-1"></a>  <span class="do">## the table form avoids unnecessary looping over the rolls</span></span>
<span id="cb50-188"><a href="#cb50-188" aria-hidden="true" tabindex="-1"></a>  <span class="do">## sum over all the possible winnings</span></span>
<span id="cb50-189"><a href="#cb50-189" aria-hidden="true" tabindex="-1"></a>  winnings <span class="ot">&lt;-</span> <span class="fu">sum</span>(rollWinnings[<span class="fu">as.numeric</span>(<span class="fu">names</span>(tRolls))] <span class="sc">*</span> tRolls)</span>
<span id="cb50-190"><a href="#cb50-190" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-191"><a href="#cb50-191" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cat</span>(<span class="st">"Total Winnings: "</span>, winnings<span class="sc">+</span>deficit))</span>
<span id="cb50-192"><a href="#cb50-192" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-193"><a href="#cb50-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-194"><a href="#cb50-194" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-195"><a href="#cb50-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-196"><a href="#cb50-196" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Loop with Apply</span></span>
<span id="cb50-197"><a href="#cb50-197" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-200"><a href="#cb50-200" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-201"><a href="#cb50-201" aria-hidden="true" tabindex="-1"></a><span class="do">## Function takes as input the number of dice rolls to play</span></span>
<span id="cb50-202"><a href="#cb50-202" aria-hidden="true" tabindex="-1"></a>loopApply <span class="ot">&lt;-</span> <span class="cf">function</span>(num) {</span>
<span id="cb50-203"><a href="#cb50-203" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-204"><a href="#cb50-204" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Check if input is numeric</span></span>
<span id="cb50-205"><a href="#cb50-205" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">is.double</span>(num) <span class="sc">==</span> <span class="cn">TRUE</span>) {</span>
<span id="cb50-206"><a href="#cb50-206" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-207"><a href="#cb50-207" aria-hidden="true" tabindex="-1"></a>    <span class="do">## If numeric then check if contains decimal</span></span>
<span id="cb50-208"><a href="#cb50-208" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">==</span> <span class="dv">0</span>) {</span>
<span id="cb50-209"><a href="#cb50-209" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-210"><a href="#cb50-210" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given it's not a decimal convert to integer</span></span>
<span id="cb50-211"><a href="#cb50-211" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb50-212"><a href="#cb50-212" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-213"><a href="#cb50-213" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-214"><a href="#cb50-214" aria-hidden="true" tabindex="-1"></a>    <span class="do">## Given decimal check if a negative number was given</span></span>
<span id="cb50-215"><a href="#cb50-215" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> <span class="cf">if</span> (num<span class="sc">-</span><span class="fu">as.integer</span>(num) <span class="sc">&lt;</span> <span class="dv">0</span>) {</span>
<span id="cb50-216"><a href="#cb50-216" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-217"><a href="#cb50-217" aria-hidden="true" tabindex="-1"></a>      <span class="do">## If negative decimal then tell user how number for converted</span></span>
<span id="cb50-218"><a href="#cb50-218" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Negative entered value:"</span>, num, <span class="st">"was converted to"</span>, <span class="fu">as.integer</span>(<span class="sc">-</span>num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-219"><a href="#cb50-219" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(<span class="sc">-</span>num)</span>
<span id="cb50-220"><a href="#cb50-220" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-221"><a href="#cb50-221" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-222"><a href="#cb50-222" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span> {</span>
<span id="cb50-223"><a href="#cb50-223" aria-hidden="true" tabindex="-1"></a>      </span>
<span id="cb50-224"><a href="#cb50-224" aria-hidden="true" tabindex="-1"></a>      <span class="do">## Given positive decimal convert accordingly</span></span>
<span id="cb50-225"><a href="#cb50-225" aria-hidden="true" tabindex="-1"></a>      <span class="fu">cat</span>(<span class="st">"Entered value:"</span>, num, <span class="st">"converted to"</span>, <span class="fu">as.integer</span>(num), <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-226"><a href="#cb50-226" aria-hidden="true" tabindex="-1"></a>      num <span class="ot">&lt;-</span> <span class="fu">as.integer</span>(num)</span>
<span id="cb50-227"><a href="#cb50-227" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-228"><a href="#cb50-228" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-229"><a href="#cb50-229" aria-hidden="true" tabindex="-1"></a>  <span class="cf">else</span> <span class="cf">if</span> (<span class="fu">is.numeric</span>(num) <span class="sc">==</span> <span class="cn">FALSE</span>) {</span>
<span id="cb50-230"><a href="#cb50-230" aria-hidden="true" tabindex="-1"></a>    <span class="fu">print</span>(<span class="st">"Please enter a natural number, eg. 1, 2, 3, ..."</span>)</span>
<span id="cb50-231"><a href="#cb50-231" aria-hidden="true" tabindex="-1"></a>    <span class="cf">break</span></span>
<span id="cb50-232"><a href="#cb50-232" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-233"><a href="#cb50-233" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-234"><a href="#cb50-234" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Create player deficit</span></span>
<span id="cb50-235"><a href="#cb50-235" aria-hidden="true" tabindex="-1"></a>  deficit <span class="ot">=</span> <span class="sc">-</span>(<span class="dv">2</span><span class="sc">*</span>num)</span>
<span id="cb50-236"><a href="#cb50-236" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-237"><a href="#cb50-237" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Simulate 'n'= num Dice Rolls</span></span>
<span id="cb50-238"><a href="#cb50-238" aria-hidden="true" tabindex="-1"></a>  rolls <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, num, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb50-239"><a href="#cb50-239" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-240"><a href="#cb50-240" aria-hidden="true" tabindex="-1"></a>  <span class="do">## create a vector specifying winnings for each roll</span></span>
<span id="cb50-241"><a href="#cb50-241" aria-hidden="true" tabindex="-1"></a>  rollWinnings <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">6</span>, <span class="dv">0</span>, <span class="dv">10</span>, <span class="dv">0</span>)</span>
<span id="cb50-242"><a href="#cb50-242" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-243"><a href="#cb50-243" aria-hidden="true" tabindex="-1"></a>  <span class="do">## Using the apply function to sum up the winnings</span></span>
<span id="cb50-244"><a href="#cb50-244" aria-hidden="true" tabindex="-1"></a>  winnings <span class="ot">&lt;-</span> <span class="fu">apply</span>(<span class="fu">as.matrix</span>(rollWinnings[rolls]), <span class="dv">2</span>, sum)</span>
<span id="cb50-245"><a href="#cb50-245" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-246"><a href="#cb50-246" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">cat</span>(<span class="st">"Total Winnings: "</span>, winnings<span class="sc">+</span>deficit))</span>
<span id="cb50-247"><a href="#cb50-247" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-248"><a href="#cb50-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-249"><a href="#cb50-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-250"><a href="#cb50-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-251"><a href="#cb50-251" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part B</span></span>
<span id="cb50-252"><a href="#cb50-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-253"><a href="#cb50-253" aria-hidden="true" tabindex="-1"></a>The following bit of code is here to demonstrate through examples that each of the functions work.</span>
<span id="cb50-254"><a href="#cb50-254" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-255"><a href="#cb50-255" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Simple Loop</span></span>
<span id="cb50-258"><a href="#cb50-258" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-259"><a href="#cb50-259" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb50-260"><a href="#cb50-260" aria-hidden="true" tabindex="-1"></a><span class="fu">loop</span>(<span class="dv">3</span>)</span>
<span id="cb50-261"><a href="#cb50-261" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-262"><a href="#cb50-262" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb50-263"><a href="#cb50-263" aria-hidden="true" tabindex="-1"></a><span class="fu">loop</span>(<span class="dv">3000</span>)</span>
<span id="cb50-264"><a href="#cb50-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-265"><a href="#cb50-265" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-266"><a href="#cb50-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-267"><a href="#cb50-267" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vectorized Function</span></span>
<span id="cb50-270"><a href="#cb50-270" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-271"><a href="#cb50-271" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb50-272"><a href="#cb50-272" aria-hidden="true" tabindex="-1"></a><span class="fu">vectorized</span>(<span class="dv">3</span>)</span>
<span id="cb50-273"><a href="#cb50-273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-274"><a href="#cb50-274" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb50-275"><a href="#cb50-275" aria-hidden="true" tabindex="-1"></a><span class="fu">vectorized</span>(<span class="dv">3000</span>)</span>
<span id="cb50-276"><a href="#cb50-276" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-277"><a href="#cb50-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-278"><a href="#cb50-278" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vectorized with Tables</span></span>
<span id="cb50-281"><a href="#cb50-281" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-282"><a href="#cb50-282" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb50-283"><a href="#cb50-283" aria-hidden="true" tabindex="-1"></a><span class="fu">tableVectorized</span>(<span class="dv">3</span>)</span>
<span id="cb50-284"><a href="#cb50-284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-285"><a href="#cb50-285" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb50-286"><a href="#cb50-286" aria-hidden="true" tabindex="-1"></a><span class="fu">tableVectorized</span>(<span class="dv">3000</span>)</span>
<span id="cb50-287"><a href="#cb50-287" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-288"><a href="#cb50-288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-289"><a href="#cb50-289" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Loop with Apply</span></span>
<span id="cb50-292"><a href="#cb50-292" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-293"><a href="#cb50-293" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb50-294"><a href="#cb50-294" aria-hidden="true" tabindex="-1"></a><span class="fu">loopApply</span>(<span class="dv">3</span>)</span>
<span id="cb50-295"><a href="#cb50-295" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-296"><a href="#cb50-296" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb50-297"><a href="#cb50-297" aria-hidden="true" tabindex="-1"></a><span class="fu">loopApply</span>(<span class="dv">3000</span>)</span>
<span id="cb50-298"><a href="#cb50-298" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-299"><a href="#cb50-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-300"><a href="#cb50-300" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part C</span></span>
<span id="cb50-301"><a href="#cb50-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-302"><a href="#cb50-302" aria-hidden="true" tabindex="-1"></a>Set a seed in order to demonstrate that each of the 4 functions output the same results.</span>
<span id="cb50-303"><a href="#cb50-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-304"><a href="#cb50-304" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Simple Loop</span></span>
<span id="cb50-307"><a href="#cb50-307" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-308"><a href="#cb50-308" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb50-309"><a href="#cb50-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-310"><a href="#cb50-310" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb50-311"><a href="#cb50-311" aria-hidden="true" tabindex="-1"></a><span class="fu">loop</span>(<span class="dv">3</span>)</span>
<span id="cb50-312"><a href="#cb50-312" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-313"><a href="#cb50-313" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb50-314"><a href="#cb50-314" aria-hidden="true" tabindex="-1"></a><span class="fu">loop</span>(<span class="dv">3000</span>)</span>
<span id="cb50-315"><a href="#cb50-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-316"><a href="#cb50-316" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-317"><a href="#cb50-317" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-318"><a href="#cb50-318" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vectorized Function</span></span>
<span id="cb50-321"><a href="#cb50-321" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-322"><a href="#cb50-322" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb50-323"><a href="#cb50-323" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-324"><a href="#cb50-324" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb50-325"><a href="#cb50-325" aria-hidden="true" tabindex="-1"></a><span class="fu">vectorized</span>(<span class="dv">3</span>)</span>
<span id="cb50-326"><a href="#cb50-326" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-327"><a href="#cb50-327" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb50-328"><a href="#cb50-328" aria-hidden="true" tabindex="-1"></a><span class="fu">vectorized</span>(<span class="dv">3000</span>)</span>
<span id="cb50-329"><a href="#cb50-329" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-330"><a href="#cb50-330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-331"><a href="#cb50-331" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vectorized with Tables</span></span>
<span id="cb50-334"><a href="#cb50-334" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-335"><a href="#cb50-335" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb50-336"><a href="#cb50-336" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-337"><a href="#cb50-337" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb50-338"><a href="#cb50-338" aria-hidden="true" tabindex="-1"></a><span class="fu">tableVectorized</span>(<span class="dv">3</span>)</span>
<span id="cb50-339"><a href="#cb50-339" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-340"><a href="#cb50-340" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb50-341"><a href="#cb50-341" aria-hidden="true" tabindex="-1"></a><span class="fu">tableVectorized</span>(<span class="dv">3000</span>)</span>
<span id="cb50-342"><a href="#cb50-342" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-343"><a href="#cb50-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-344"><a href="#cb50-344" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Loop with Apply</span></span>
<span id="cb50-347"><a href="#cb50-347" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-348"><a href="#cb50-348" aria-hidden="true" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">10</span>)</span>
<span id="cb50-349"><a href="#cb50-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-350"><a href="#cb50-350" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3</span></span>
<span id="cb50-351"><a href="#cb50-351" aria-hidden="true" tabindex="-1"></a><span class="fu">loopApply</span>(<span class="dv">3</span>)</span>
<span id="cb50-352"><a href="#cb50-352" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-353"><a href="#cb50-353" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 3000</span></span>
<span id="cb50-354"><a href="#cb50-354" aria-hidden="true" tabindex="-1"></a><span class="fu">loopApply</span>(<span class="dv">3000</span>)</span>
<span id="cb50-355"><a href="#cb50-355" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-356"><a href="#cb50-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-357"><a href="#cb50-357" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part D</span></span>
<span id="cb50-358"><a href="#cb50-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-359"><a href="#cb50-359" aria-hidden="true" tabindex="-1"></a>The 'microbenchmark' package will now be used to calculate the speed for each of the implementations.</span>
<span id="cb50-360"><a href="#cb50-360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-361"><a href="#cb50-361" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Simple Loop</span></span>
<span id="cb50-364"><a href="#cb50-364" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-365"><a href="#cb50-365" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(<span class="st">"microbenchmark"</span>)</span>
<span id="cb50-366"><a href="#cb50-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-367"><a href="#cb50-367" aria-hidden="true" tabindex="-1"></a><span class="do">## Input of 1000 vs 100,000</span></span>
<span id="cb50-368"><a href="#cb50-368" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">loop</span>(<span class="dv">1000</span>), <span class="fu">loop</span>(<span class="dv">100000</span>))</span>
<span id="cb50-369"><a href="#cb50-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-370"><a href="#cb50-370" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-371"><a href="#cb50-371" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-372"><a href="#cb50-372" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vectorized Function</span></span>
<span id="cb50-375"><a href="#cb50-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-376"><a href="#cb50-376" aria-hidden="true" tabindex="-1"></a><span class="do">## Input 1,000 vs 100,000</span></span>
<span id="cb50-377"><a href="#cb50-377" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">vectorized</span>(<span class="dv">1000</span>), <span class="fu">vectorized</span>(<span class="dv">100000</span>))</span>
<span id="cb50-378"><a href="#cb50-378" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-379"><a href="#cb50-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-380"><a href="#cb50-380" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Vectorized with Tables</span></span>
<span id="cb50-383"><a href="#cb50-383" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-384"><a href="#cb50-384" aria-hidden="true" tabindex="-1"></a><span class="do">## Input 1,000 vs 100,000</span></span>
<span id="cb50-385"><a href="#cb50-385" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">tableVectorized</span>(<span class="dv">1000</span>), <span class="fu">tableVectorized</span>(<span class="dv">100000</span>))</span>
<span id="cb50-386"><a href="#cb50-386" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-387"><a href="#cb50-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-388"><a href="#cb50-388" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Loop with Apply</span></span>
<span id="cb50-391"><a href="#cb50-391" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-392"><a href="#cb50-392" aria-hidden="true" tabindex="-1"></a><span class="do">## Input 1,000 vs 100,000</span></span>
<span id="cb50-393"><a href="#cb50-393" aria-hidden="true" tabindex="-1"></a><span class="fu">microbenchmark</span>(<span class="fu">loopApply</span>(<span class="dv">1000</span>), <span class="fu">loopApply</span>(<span class="dv">100000</span>))</span>
<span id="cb50-394"><a href="#cb50-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-395"><a href="#cb50-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-396"><a href="#cb50-396" aria-hidden="true" tabindex="-1"></a>I was surprised to see that the Vectorized function which utilized a table was slower than all the other functions. I was under the assumption that using a table would have at least reduced the calculation time over the for loop used for the simple loop function, since we could use the table's index. Aside from that surprising result, loopApply was faster than the simple loop function but the fastest was the purely vectorized function. </span>
<span id="cb50-397"><a href="#cb50-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-398"><a href="#cb50-398" aria-hidden="true" tabindex="-1"></a>Thus in order of the fastest to the slowest: </span>
<span id="cb50-399"><a href="#cb50-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-400"><a href="#cb50-400" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>vectorized</span>
<span id="cb50-401"><a href="#cb50-401" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>loopApply</span>
<span id="cb50-402"><a href="#cb50-402" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>loop 'simple loop'</span>
<span id="cb50-403"><a href="#cb50-403" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>tableVectorized</span>
<span id="cb50-404"><a href="#cb50-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-405"><a href="#cb50-405" aria-hidden="true" tabindex="-1"></a><span class="fu">### Part E</span></span>
<span id="cb50-406"><a href="#cb50-406" aria-hidden="true" tabindex="-1"></a><span class="fu">#### Monte Carlo Simulation</span></span>
<span id="cb50-407"><a href="#cb50-407" aria-hidden="true" tabindex="-1"></a>The idea of a game being fair in my opinion relies upon an equal chance for the player to make money vs lose money. For example, in a game of tossing a coin and calling a side, the player would have an equal chance of both winning and losing.  </span>
<span id="cb50-408"><a href="#cb50-408" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-411"><a href="#cb50-411" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb50-412"><a href="#cb50-412" aria-hidden="true" tabindex="-1"></a><span class="do">## Monte Carlo simulation</span></span>
<span id="cb50-413"><a href="#cb50-413" aria-hidden="true" tabindex="-1"></a>monte <span class="ot">&lt;-</span> <span class="cf">function</span>(reps) {</span>
<span id="cb50-414"><a href="#cb50-414" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-415"><a href="#cb50-415" aria-hidden="true" tabindex="-1"></a>  <span class="do">## roll the dice from 1 to 1000 on various increments</span></span>
<span id="cb50-416"><a href="#cb50-416" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> (rolls <span class="cf">in</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">10</span>,<span class="dv">20</span>,<span class="dv">40</span>,<span class="dv">60</span>,<span class="dv">80</span>,<span class="dv">100</span>,<span class="dv">1000</span>)) {</span>
<span id="cb50-417"><a href="#cb50-417" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-418"><a href="#cb50-418" aria-hidden="true" tabindex="-1"></a>    <span class="do">## create an empty vector sized according to the reps</span></span>
<span id="cb50-419"><a href="#cb50-419" aria-hidden="true" tabindex="-1"></a>    v <span class="ot">&lt;-</span> <span class="fu">vector</span>(<span class="at">length =</span> reps)</span>
<span id="cb50-420"><a href="#cb50-420" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb50-421"><a href="#cb50-421" aria-hidden="true" tabindex="-1"></a>    <span class="do">## cycle through the reps and calculate the total winnings</span></span>
<span id="cb50-422"><a href="#cb50-422" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> (i <span class="cf">in</span> <span class="fu">seq_len</span>(reps)) {</span>
<span id="cb50-423"><a href="#cb50-423" aria-hidden="true" tabindex="-1"></a>      v[i] <span class="ot">&lt;-</span> <span class="fu">vectorized</span>(rolls)</span>
<span id="cb50-424"><a href="#cb50-424" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb50-425"><a href="#cb50-425" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb50-426"><a href="#cb50-426" aria-hidden="true" tabindex="-1"></a>    <span class="do">## save rolls and their winnings as a table</span></span>
<span id="cb50-427"><a href="#cb50-427" aria-hidden="true" tabindex="-1"></a>    winnings <span class="ot">&lt;-</span> <span class="fu">table</span>(v)</span>
<span id="cb50-428"><a href="#cb50-428" aria-hidden="true" tabindex="-1"></a>    <span class="do">## calculate probability to rolls that result in a profit</span></span>
<span id="cb50-429"><a href="#cb50-429" aria-hidden="true" tabindex="-1"></a>    profit <span class="ot">&lt;-</span> <span class="fu">sum</span>(winnings[<span class="fu">as.numeric</span>(<span class="fu">names</span>(winnings))<span class="sc">&gt;</span>(<span class="dv">0</span>)])<span class="sc">/</span>reps</span>
<span id="cb50-430"><a href="#cb50-430" aria-hidden="true" tabindex="-1"></a>     </span>
<span id="cb50-431"><a href="#cb50-431" aria-hidden="true" tabindex="-1"></a>    <span class="do">## print the current roll and the amount profit</span></span>
<span id="cb50-432"><a href="#cb50-432" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cat</span>(<span class="st">"Rolls:"</span>, rolls, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>,</span>
<span id="cb50-433"><a href="#cb50-433" aria-hidden="true" tabindex="-1"></a>        <span class="st">"P(Profit)="</span>, profit, <span class="st">"</span><span class="sc">\n</span><span class="st">"</span>)</span>
<span id="cb50-434"><a href="#cb50-434" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb50-435"><a href="#cb50-435" aria-hidden="true" tabindex="-1"></a>  <span class="do">## at the very end return the final histogram containing the</span></span>
<span id="cb50-436"><a href="#cb50-436" aria-hidden="true" tabindex="-1"></a>  <span class="do">## user defined repetitions</span></span>
<span id="cb50-437"><a href="#cb50-437" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">hist</span>(v, <span class="at">main=</span><span class="fu">paste</span>(<span class="st">"Histogram of"</span>, reps, <span class="st">"Repetition"</span>)))</span>
<span id="cb50-438"><a href="#cb50-438" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-439"><a href="#cb50-439" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-440"><a href="#cb50-440" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb50-441"><a href="#cb50-441" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-442"><a href="#cb50-442" aria-hidden="true" tabindex="-1"></a>According to the simulation it seems that this game is very much in favor of the player. If they spend 4 dollar (2 rolls) they will have about a 55% chance of making a profit. That chance will increase to about 90% if they spend 120 dollars (60 rolls). This game isn't very 'fair' for the house since they are very likely to lose money. One way of making the game fair would be to lower the winnings for rolling a 3 or a 5. </span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->




</body></html>